<!doctype html>
<html
	lang="en" >
	<head>
		<title>
            Caio Raphael
		</title>
		<meta
			charset="utf-8" >
		<meta
			name="viewport" 
			content="width=device-width, initial-scale=1" >
		<meta
			name="description" 
			content="Senior Game Developer, Engine Developer, Low-Level Network, Low-Level Systems" >
		<meta
			name="author" 
			content="Caio Raphael" >
		<meta
			name="theme-color" 
			content="#ffffff" 
			media="(prefers-color-scheme: light)" >
		<meta
			name="theme-color" 
			content="#101010" 
			media="(prefers-color-scheme: dark)" >
		<link
			rel="icon" 
			href="/assets/icon.ico" >
		<link
			rel="icon" 
			href="/assets/icon-16x16.png" 
			sizes="16x16" 
			type="image/png" >
		<link
			rel="icon" 
			href="/assets/icon-32x32.png" 
			sizes="32x32" 
			type="image/png" >
		<script>
window.MathJax = {
                tex: {
                    inlineMath: [['$', '$']],
                    displayMath: [['$$', '$$']]
                }
                };
		</script>
		<script
			src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" >
		</script>
		<script
			type="module" >

                    import hljs from 'https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/highlight.min.js';
                    import hljs_odin from 'https://unpkg.com/highlightjs-odinlang@1.4.0/dist/odin.es.min.js';
                    import hljs_glsl from 'https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/languages/glsl.min.js';
                    import hljs_swift  from 'https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/languages/swift.min.js';
                    hljs.registerLanguage('odin', hljs_odin);
                    hljs.registerLanguage('glsl', hljs_glsl);
                    hljs.registerLanguage('gdscript', hljs_swift);
                    hljs.highlightAll();
                
		</script>
		<link
			rel="stylesheet" 
			href="/static/studies.08621.css" >
	</head>
	<body>
		<aside
			id="left-sidebar-wrapper" >
			<div
				id="left-sidebar" >
				<header>
					<a
						href="/" 
						class="site-logo" >
                        Caio Raphael
					</a>
					<p
						class="breadcrums-division" >
                        /
					</p>
					<a
						href="/studies/_index.html" 
						class="breadcrumbs-studies" >
                        Studies
					</a>
				</header>
				<nav>
					<details
						open="">
						<summary>
                            Vulkan
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-basic.html" >
                                    Basic
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-samples.html" >
                                    Samples
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-core.html" >
                                    Core
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-render-loop.html" >
                                    Render Loop
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-synchronization-and-cache-control.html" >
                                    Synchronization and Cache Control
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-command-buffers.html" >
                                    Command Buffers
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-pipelines.html" >
                                    Pipelines
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-graphics-pipeline.html" >
                                    Graphics Pipeline
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-compute-pipeline.html" >
                                    Compute Pipeline
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-resources.html" >
                                    Resources
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-depth.html" >
                                    Depth
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-mapping-data-to-shaders.html" >
                                    Mapping Data to Shaders
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-memory-allocation.html" >
                                    Memory Allocation
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="active" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-hdr-support.html" >
                                    HDR Support
								</a>
								<ul>
									<li>
										<a
											href="#drawing-to-a-high-precision-image-coder16g16b16a16_sfloat-code" >
                                            Drawing to a High Precision Image (<code>R16G16B16A16_SFLOAT</code>)
										</a>
										<ul>
										</ul>
									</li>
									<li>
										<a
											href="#etc" >
                                            Etc
										</a>
									</li>
								</ul>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-profiling.html" >
                                    Profiling
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-mobile.html" >
                                    Mobile
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-vr.html" >
                                    VR
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-video-decoding.html" >
                                    Video Decoding
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-spir-v.html" >
                                    SPIR-V
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Vulkan/Vulkan-web.html" >
                                    Web
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            Render Engineering
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-graphics-apis.html" >
                                    Graphics APIs
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-shader-languages.html" >
                                    Shader Languages
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-tools.html" >
                                    Tools
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-choosing-the-space-to-compute-lighting.html" >
                                    Choosing the Space to compute Lighting
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-bsdf-bidirectional-scattering-distribution-function.html" >
                                    BSDF (Bidirectional Scattering Distribution Function)
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-material.html" >
                                    Material
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-direct-lighting.html" >
                                    Direct Lighting
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-shadows.html" >
                                    Shadows
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-skybox-skydome.html" >
                                    Skybox / Skydome
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-transparency.html" >
                                    Transparency
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-global-illumination-indirect-lighting.html" >
                                    Global Illumination / Indirect Lighting
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-global-illumination-solutions.html" >
                                    Global Illumination - Solutions
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-global-illumination-discarded-solutions.html" >
                                    Global Illumination - Discarded Solutions
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-lightmaps.html" >
                                    Lightmaps
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-post-processing.html" >
                                    Post-Processing
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-anti-aliasing.html" >
                                    Anti-Aliasing
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-light-path-rendering-method.html" >
                                    Light Path / Rendering Method
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Render Engineering/Render Engineering-optimization-techniques.html" >
                                    Optimization Techniques
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            Graphics and Shaders
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Graphics and Shaders/Graphics and Shaders-sources.html" >
                                    Sources
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Graphics and Shaders/Graphics and Shaders-math-linear-algebra.html" >
                                    Math, Linear Algebra
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Graphics and Shaders/Graphics and Shaders-spaces-transformations-and-graphics-pipeline.html" >
                                    Spaces, Transformations and Graphics Pipeline
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Graphics and Shaders/Graphics and Shaders-common-techniques.html" >
                                    Common Techniques
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Graphics and Shaders/Graphics and Shaders-shaders.html" >
                                    Shaders
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            GLSL
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GLSL/GLSL-basic.html" >
                                    Basic
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GLSL/GLSL-storage-qualifiers.html" >
                                    Storage Qualifiers
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GLSL/GLSL-layout-qualifiers.html" >
                                    Layout Qualifiers
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            GPU
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GPU/GPU-execution-building-blocks.html" >
                                    Execution Building Blocks
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GPU/GPU-specialized-units-and-instructions.html" >
                                    Specialized units &amp; instructions
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GPU/GPU-memory.html" >
                                    Memory
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GPU/GPU-cache.html" >
                                    Cache
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GPU/GPU-gpu-va-virtual-address.html" >
                                    GPU VA (Virtual Address)
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/GPU/GPU-tiled-gpus.html" >
                                    Tiled-GPUs
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            Slang
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Slang-slang.html" >
                                    Slang
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            Font Rendering
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-techniques.html" >
                                    Techniques
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-text-processing-pipeline.html" >
                                    Text Processing Pipeline
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-concepts.html" >
                                    Concepts
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-formats.html" >
                                    Formats
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-libs.html" >
                                    Libs
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-tools.html" >
                                    Tools
								</a>
							</li>
						</ul>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/Font Rendering-fonts.html" >
                                    Fonts
								</a>
							</li>
						</ul>
					</details>
					<details
>
						<summary>
                            OpenGL
						</summary>
						<ul>
							<li>
								<a
									class="" 
									href="/studies/Graphics Programming/OpenGL/OpenGL-about.html" >
                                    About
								</a>
							</li>
						</ul>
					</details>
				</nav>
			</div>
		</aside>
		<main
			id="central-wrapper" >
			<main
				id="note-wrapper" >
				<header
					id="note-header" >
					<h1>
                        HDR Support
					</h1>
					<p>
						<time
							datetime="2025-08-01" >
                            üïí Created: 2025-08-01
						</time>
						<time
							datetime="2026-02-11" >
                            | Updated: 2026-02-11
						</time>
					</p>
				</header>
				<article
					id="note-content" >
<ul>
	<li>
		<p>
            Shader code converts high-dynamic-range (HDR) linear color values (often stored in floating formats like 
            <code>R16G16B16A16_SFLOAT</code>
            ) into display-referred low-dynamic-range (LDR) values (sRGB or the swapchain format).
		</p>
	</li>
	<li>
		<p>
            Operations include exposure, clamping, tone curve (Reinhard, ACES, filmic), and gamma or sRGB conversion.
		</p>
	</li>
	<li>
		<p>
			<a
				href="https://www.youtube.com/shorts/0M7INvSHSRk" 
				class="external-link" 
				target="_blank" >
                Each monitor manufacturer does this differently; it's not standardized
			</a>
            .
		</p>
	</li>
	<li>
		<p>
            Inputs:
		</p>
		<ul>
			<li>
				<p>
                    HDR color (linear), optionally exposure/exposure texture, bloom, eye adaptation.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
            Steps (example minimal):
		</p>
		<ol>
			<li>
				<p>
                    Multiply by exposure.
				</p>
			</li>
			<li>
				<p>
                    Apply curve (e.g. Reinhard: 
                    <code>c/(1+c)</code>
                    , or ACES approximation).
				</p>
			</li>
			<li>
				<p>
                    Convert to sRGB/gamma (
                    <code>pow(color, 1.0/2.2)</code>
                    ) or use proper sRGB conversion.
				</p>
			</li>
			<li>
				<p>
                    Output 
                    <code>vec4</code>
                    &nbsp;clamped to 
                    <code>[0,1]</code>
                    &nbsp;into swapchain format (e.g. 
                    <code>FORMAT_B8G8R8A8_UNORM</code>
                    ).
				</p>
			</li>
		</ol>
	</li>
</ul>
<h3
	id="drawing-to-a-high-precision-image-coder16g16b16a16_sfloat-code" >
    Drawing to a High Precision Image (
    <code>R16G16B16A16_SFLOAT</code>
    )
</h3>
<ul>
	<li>
		<p>
            Rendering into an 
            <code>R16G16B16A16_SFLOAT</code>
            &nbsp;(FP16) image provides:
		</p>
		<ul>
			<li>
				<p>
                    Higher dynamic range and precision (light accumulation &gt; 1.0, less banding, better tone mapping).
				</p>
			</li>
			<li>
				<p>
                    Freedom to tone-map and convert later.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
            This is the 
			<em>
                engine-side HDR pipeline
			</em>
            .
		</p>
	</li>
	<li>
		<p>
			<a
				href="https://vkguide.dev/docs/new_chapter_2/vulkan_new_rendering/#new-draw-loop" 
				class="external-link" 
				target="_blank" >
                Described technique
			</a>
            .
		</p>
		<ul>
			<li>
				<p>
                    From &quot;New draw loop&quot; until the end.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
            Rendering into a separate high-precision offscreen target and then copying/blitting/tonemapping into the swapchain is the standard approach when you need arbitrary internal resolution, higher precision, HDR processing, or when the swapchain does not expose desired formats/usages. The trade-off is the extra memory and an explicit copy/blit or import step; the benefit is control over precision and size. The Vulkan command 
            <code>vkCmdBlitImage</code>
            &nbsp;/ transfer usage or a shader-based blit/resolve are the usual mechanisms to move from the internal target to the presentable image.
		</p>
	</li>
	<li>
		<p>
            The image we will be using is going to be in the RGBA 16-bit float format.
		</p>
		<ul>
			<li>
				<p>
                    <code>R16G16B16A16_SFLOAT</code>
                    &nbsp;is a common intermediate HDR format (16-bit float per channel). It increases memory and bandwidth (roughly 2√ó vs 8-bit RGBA) and may affect GPU/VRAM usage and upload/download costs; it also reduces quantization/banding and supports HDR/light-accumulation workflows without clamping at 1.0. The choice is an explicit trade-off: more precision (and headroom for lighting) vs more memory/bandwidth. The format is widely supported for offscreen images but may not be available as a swapchain format on all platforms, which reinforces the decision to render offscreen then convert/tonemap for presentation.
				</p>
			</li>
			<li>
				<p>
                    This is slightly overkill, but will provide us with a lot of extra pixel precision that will come in handy when doing lighting calculations and better rendering.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
            It's possible to apply low-latency techniques where we could be rendering into a different image from the swapchain image, and then directly push that image to the swapchain with very low latency.
		</p>
		<ul>
			<li>
				<p>
                    Techniques like NVIDIA's &quot;Latency Markers&quot; / Reflex or AMD's Anti-Lag rely on starting rendering work as early as possible, often 
					<em>
                        before
					</em>
                    &nbsp;the presentation engine signals readiness for the next frame via 
                    <code>vkAcquireNextImageKHR</code>
                    &nbsp;(Vulkan) or 
                    <code>AcquireNextFrame</code>
                    &nbsp;(DXGI). This necessitates rendering into a separate, persistently available image. The swapchain image index is only provided at acquisition time, making pre-rendering impossible with direct swapchain targets. Documentation for these low-latency SDKs implicitly requires separate render targets.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
            Choosing the image tiling:
		</p>
		<ul>
			<li>
				<p>
                    We can then copy that image into the swapchain image and present it to the screen.
				</p>
			</li>
			<li>
				<p>
                    <code>VkCmdCopyImage</code>
				</p>
				<ul>
					<li>
						<p>
                            Is faster, but its much more restricted, for example the resolution on both images must match.
						</p>
					</li>
				</ul>
			</li>
			<li>
				<p>
                    <code>VkCmdBlitImage</code>
				</p>
				<ul>
					<li>
						<p>
                            Lets you copy images of different formats and different sizes into one another.
						</p>
					</li>
					<li>
						<p>
                            You have a source rectangle and a target rectangle, and the system copies it into its position.
						</p>
					</li>
				</ul>
			</li>
		</ul>
	</li>
	<li>
		<p>
			<em>
                New code for transitioning
			</em>
            :
		</p>
<pre><code class="language-cpp" data-lang="cpp">_drawExtent.width = _drawImage.imageExtent.width;
_drawExtent.height = _drawImage.imageExtent.height;

CHECK(vkBeginCommandBuffer(cmd, &cmdBeginInfo)); 

// transition our main draw image into general layout so we can write into it
// we will overwrite it all so we dont care about what was the older layout
vkutil::transition_image(cmd, _drawImage.image, IMAGE_LAYOUT_UNDEFINED, IMAGE_LAYOUT_GENERAL);

draw_background(cmd);

//transition the draw image and the swapchain image into their correct transfer layouts
vkutil::transition_image(cmd, _drawImage.image, IMAGE_LAYOUT_GENERAL, IMAGE_LAYOUT_TRANSFER_SRC_OPTIMAL);
vkutil::transition_image(cmd, _swapchainImages[swapchainImageIndex], IMAGE_LAYOUT_UNDEFINED, IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL);

// execute a copy from the draw image into the swapchain
vkutil::copy_image_to_image(cmd, _drawImage.image, _swapchainImages[swapchainImageIndex], _drawExtent, _swapchainExtent);

// set swapchain image layout to Present so we can show it on the screen
vkutil::transition_image(cmd, _swapchainImages[swapchainImageIndex], IMAGE_LAYOUT_TRANSFER_DST_OPTIMAL, IMAGE_LAYOUT_PRESENT_SRC_KHR);

//finalize the command buffer (we can no longer add commands, but it can now be executed)
CHECK(vkEndCommandBuffer(cmd));
</code></pre>
		<ul>
			<li>
				<p>
                    The main difference we have in the render loop is that we no longer do the clear on the swapchain image. Instead, we do it on the 
                    <code>_drawImage.image</code>
                    .
				</p>
			</li>
			<li>
				<p>
                    Once we have cleared the image, we transition both the swapchain and the draw image into their layouts for transfer, and we execute the copy command. Once we are done with the copy command, we transition the swapchain image into present layout for display. As we are always drawing on the same image, our draw_image does not need to access swapchain index, it just clears the draw image. We are also writing the 
                    <code>_drawExtent</code>
                    &nbsp;that we will use for our draw region.
				</p>
			</li>
		</ul>
	</li>
</ul>
<h3
	id="etc" >
    Etc
</h3>
<ul>
	<li>
		<p>
			<strong>
                But
			</strong>
            &nbsp;this image still has to be copied/tonemapped into the 
			<strong>
                swapchain format
			</strong>
            , which is typically limited to 8-bit UNORM unless the OS/driver supports HDR swapchain formats.
		</p>
	</li>
	<li>
		<p>
            To actually output HDR to the screen, all of the following conditions must be met:
		</p>
	</li>
</ul>
<ol>
	<li>
		<p>
			<strong>
                Swapchain format must support HDR bit depth
			</strong>
            .
		</p>
		<ul>
			<li>
				<p>
                    Example formats: 
                    <code>FORMAT_A2B10G10R10_UNORM_PACK32</code>
                    , 
                    <code>FORMAT_R16G16B16A16_SFLOAT</code>
                    , or platform-specific HDR surface formats.
				</p>
			</li>
			<li>
				<p>
                    You query available swapchain formats via 
                    <code>vkGetPhysicalDeviceSurfaceFormatsKHR</code>
                    .
				</p>
			</li>
			<li>
				<p>
                    If only 8-bit formats are exposed, you cannot present HDR directly.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
			<strong>
                Swapchain color space must be HDR-capable
			</strong>
		</p>
		<ul>
			<li>
				<p>
                    Vulkan allows specifying a 
                    <code>VkColorSpaceKHR</code>
                    &nbsp;(e.g., 
                    <code>COLOR_SPACE_HDR10_ST2084_EXT</code>
                    , 
                    <code>COLOR_SPACE_HDR10_HLG_EXT</code>
                    ).
				</p>
			</li>
			<li>
				<p>
                    These correspond to HDR transfer functions (PQ/HLG).
				</p>
			</li>
			<li>
				<p>
                    If the driver/surface does not expose them, the system compositor won‚Äôt accept HDR content.
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
			<strong>
                OS and display pipeline must be HDR-enabled
			</strong>
		</p>
		<ul>
			<li>
				<p>
                    Windows: HDR toggle must be enabled in system settings, compositor configured for HDR10.
				</p>
			</li>
			<li>
				<p>
                    Linux/Wayland: requires HDR support in compositor + driver (still emerging).
				</p>
			</li>
			<li>
				<p>
                    Android: requires 
                    <code>AHardwareBuffer</code>
                    &nbsp;/ 
                    <code>SurfaceView</code>
                    &nbsp;with HDR formats.
				</p>
			</li>
			<li>
				<p>
                    macOS: Metal swapchains expose extended sRGB/PQ output modes.
				</p>
			</li>
			<li>
				<p>
                    (Platform docs confirm HDR availability is compositor-driven).
				</p>
			</li>
		</ul>
	</li>
	<li>
		<p>
			<strong>
                Application side tone mapping &amp; gamut mapping
			</strong>
		</p>
		<ul>
			<li>
				<p>
                    Even if swapchain supports HDR, you generally still render into FP16, then apply:
				</p>
				<ul>
					<li>
						<p>
                            Tone mapping (map wide dynamic range ‚Üí HDR10/HLG range).
						</p>
					</li>
					<li>
						<p>
                            Color gamut conversion (usually Rec.709 ‚Üí Rec.2020 for HDR10).
						</p>
					</li>
				</ul>
			</li>
			<li>
				<p>
                    Only then write into the HDR swapchain image.
				</p>
			</li>
		</ul>
	</li>
</ol>

				</article>
			</main>
			<footer
				id="central-footer" >
                üßë‚Äçüíª built and copyrighted by
				<a
					href="https://github.com/caioraphael1" 
					target="_blank" >
                    Caio Raphael
				</a>
                üìÖ 2025-2026 üöÄ
			</footer>
		</main>
		<script
			src="/static/studies.08621.js" >
		</script>
	</body>
</html>
